import{B as D,M as f,a as m,S as B,C as H,b as L,T as O,P as w,c as M,d as G,e as v,I as R,O as W,D as V,f as q,g as F,h as I,V as d,i as k,G as K,j as U,k as j}from"./index-BXZ1-o7X.js";import{t as fe}from"./index-BXZ1-o7X.js";const i=window.__IWSDK_WORLD__,c=[],y=[],l=[],h=[],P=new WeakMap;let g=null;function N(){if(!g){g=new K;const t=new U;t.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.7/"),g.setDRACOLoader(t)}return g}const T=new Map,$={TRIGGER:"xr-standard-trigger",SQUEEZE:"xr-standard-squeeze",THUMBSTICK:"xr-standard-thumbstick",A:"a-button",B:"b-button",X:"x-button",Y:"y-button"},S=new j(16777215,1);S.position.set(1,3,1);i.scene.add(S);c.push(S);const x=.5,A=new D(20,x,20),_=new f({transparent:!0,opacity:0}),b=new m(A,_);b.position.set(0,-x/2,0);i.scene.add(b);const C=i.createTransformEntity(b);C.addComponent(M,{state:w.Static});C.addComponent(G,{shape:v.Auto,restitution:.8,friction:.5});y.push(C);c.push(b);l.push(A);h.push(_);function Q(t,e={}){const n=i.createTransformEntity(t);let s=w.Dynamic;return e.dynamic===!1&&(s=w.Static),e.kinematic&&(s=w.Kinematic),n.addComponent(M,{state:s,linearDamping:e.damping??0,angularDamping:e.angularDamping??0,gravityFactor:e.noGravity?0:1}),n.addComponent(G,{shape:v.Auto,restitution:e.restitution??(e.bouncy?.9:.5),density:e.density??(e.heavy?3:1),friction:e.friction??(e.slippery?.1:.5)}),e.grabbable!==!1&&e.dynamic!==!1&&(n.addComponent(R),e.directGrab?n.addComponent(W):n.addComponent(V,{movementMode:q.MoveFromTarget}),e.scalable&&n.addComponent(F)),y.push(n),P.set(t,n),n}function X(t,e){const n={};e.velocity&&(n.linearVelocity=e.velocity),e.impulse&&(n.force=e.impulse),e.angularVelocity&&(n.angularVelocity=e.angularVelocity),t.addComponent(I,n)}function z(t,e,n=.2){const[s,a,o]=Array.isArray(n)?n:[n,n,n],r=new D(s,a,o),u=new f({color:e,roughness:.4,metalness:.2}),p=new m(r,u);return p.position.set(...t),i.scene.add(p),c.push(p),l.push(r),h.push(u),p}function Y(t,e,n=.1){const s=new B(n,32,32),a=new f({color:e,roughness:.3,metalness:.3}),o=new m(s,a);return o.position.set(...t),i.scene.add(o),c.push(o),l.push(s),h.push(a),o}function J(t,e,n=.1,s=.3){const a=new H(n,n,s,32),o=new f({color:e,roughness:.4,metalness:.4}),r=new m(a,o);return r.position.set(...t),i.scene.add(r),c.push(r),l.push(a),h.push(o),r}function ee(t,e,n=.1,s=.25){const a=new L(n,s,32),o=new f({color:e,roughness:.3,metalness:.4}),r=new m(a,o);return r.position.set(...t),i.scene.add(r),c.push(r),l.push(a),h.push(o),r}function te(t,e,n=.1,s=.04){const a=new O(n,s,16,32),o=new f({color:e,roughness:.25,metalness:.6}),r=new m(a,o);return r.position.set(...t),i.scene.add(r),c.push(r),l.push(a),h.push(o),r}async function ne(t,e,n=1){const s=`/models/${t}/model.glb`;let a=T.get(t);a||(a=(await N().loadAsync(s)).scene,T.set(t,a));const o=a.clone();return e&&o.position.set(...e),o.scale.setScalar(n),i.scene.add(o),c.push(o),o}function se(t,e,n={}){const{color:s=16776960,radius:a=.05,speed:o=10,lifetime:r=5e3}=n,u=Y([t.x,t.y,t.z],s,a),p=Q(u,{grabbable:!1,bouncy:!0}),E=e.clone().normalize().multiplyScalar(o);return X(p,{velocity:[E.x,E.y,E.z]}),setTimeout(()=>{try{u.parent&&u.parent.remove(u),p.destroy()}catch{}},r),u}function oe(t="right"){return i.input.gamepads[t]}function ae(t="right"){const e=i.player.gripSpaces[t];if(!e)return new d(0,1,-.5);const n=new d;return e.getWorldPosition(n),n}function re(t="right"){const e=i.player.raySpaces[t];if(!e)return new d(0,0,-1);const n=new d(0,0,-1);return e.getWorldDirection(n),n.negate()}function ie(){const t=new d;return i.player.head.getWorldPosition(t),t}function ce(){const t=new d(0,0,-1);return i.player.head.getWorldDirection(t),t}function ue(t){return P.get(t)||null}function de(t,e){const n=t instanceof d?t:t.position,s=e instanceof d?e:e.position;return n.distanceTo(s)}function le(t){t.parent&&t.parent.remove(t);const e=c.indexOf(t);if(e!==-1){c.splice(e,1);const n=y[e];if(n){try{n.destroy()}catch{}y.splice(e,1)}}}function he(){window.__GAME_UPDATE__=null,c.forEach(e=>{e.parent&&e.parent.remove(e)}),y.forEach(e=>{try{e.destroy()}catch{}}),l.forEach(e=>e.dispose()),h.forEach(e=>e.dispose()),c.length=0,y.length=0,l.length=0,h.length=0;const t=i.getSystem(k);if(t){const e=t.queries.planeEntities;e?.results&&[...e.results].forEach(s=>{try{s.destroy()}catch{}});const n=t.queries.meshEntities;n?.results&&[...n.results].forEach(s=>{try{s.destroy()}catch{}})}}export{$ as Buttons,q as MovementMode,v as PhysicsShapeType,w as PhysicsState,fe as THREE,Q as addPhysics,X as applyForce,he as cleanup,z as createBox,ee as createCone,J as createCylinder,Y as createSphere,te as createTorus,de as distance,y as entities,l as geometries,re as getAimDirection,ue as getEntity,ae as getHandPosition,ce as getHeadDirection,ie as getHeadPosition,oe as getInput,ne as loadModel,h as materials,c as meshes,le as remove,se as shoot,i as world};
